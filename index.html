<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="refresh" content="30"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Ranking Game ON</title>
  <style>
    :root{
      --max-width: 820px;
      --iframe-width: 700px;
    }
    html,body{height:100%; margin:0; padding:0; font-family: Arial, sans-serif; background:#000; color:#fff;}
    body{
      background-image: url('fundo.png');
      background-size: cover;
      background-position:center;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    .top {
      margin-top:24px;
      text-align:center;
      width:100%;
    }
    .title-img { max-width:90%; height:auto; display:inline-block; }

    .subtitle {
      margin-top:8px;
      color:#ddd;
      font-size:18px;
    }

    .table-wrap {
      width:100%;
      max-width:var(--max-width);
      margin: 20px auto 0;
      padding: 18px;
      background: rgba(0,0,0,0.6);
      border-radius: 8px;
      box-sizing: border-box;
      display:flex;
      justify-content:center;
    }

    table.ranking {
      width: var(--iframe-width);
      max-width: 100%;
      border-collapse: collapse;
      background: rgba(255,255,255,0.03);
    }
    table.ranking th{
      text-align:left;
      padding:10px 12px;
      color:#fff;
      font-weight:700;
      font-size:16px;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }
    table.ranking td{
      padding:10px 12px;
      color:#eee;
      border-bottom: 1px solid rgba(255,255,255,0.03);
      font-size:15px;
    }
    table.ranking tr:nth-child(odd){ background: rgba(255,255,255,0.01); }

    .footer {
      margin: 28px 0;
      display:flex;
      align-items:center;
      gap:10px;
      color:#fff;
      font-weight:600;
    }
    .footer img{ height:70px; display:block; }

    /* destaque 1-3 */
    .rank-1 td { background: linear-gradient(90deg, rgba(255,215,0,0.12), transparent); font-weight:700; }
    .rank-2 td { background: linear-gradient(90deg, rgba(192,192,192,0.08), transparent); }
    .rank-3 td { background: linear-gradient(90deg, rgba(205,127,50,0.06), transparent); }

    /* responsivo */
    @media (max-width:700px){
      :root{--iframe-width: 320px;}
      .title-img{ max-width: 320px; }
      .footer img{ height:48px; }
    }
  </style>
</head>
<body>
  <div class="top">
    <img src="titulo.png" alt="Ranking Game ON" class="title-img"/>
    <div class="subtitle">Acompanhe a classifica√ß√£o em tempo real üèÜ</div>
  </div>

  <div class="table-wrap">
    <table class="ranking" id="rankingTable" aria-live="polite">
      <thead>
        <tr>
          <th>Nome</th><th>Escola</th><th>Pontos</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="3" style="padding:18px; color:#ccc; text-align:center;">Carregando...</td></tr>
      </tbody>
    </table>
  </div>

  <div class="footer">
    <img src="banners game on- logo.png" alt="Logo Game ON"/>
    <div>2025 ETE FMC</div>
  </div>

  <script>
    // URL do Web App do Google Apps Script (com par√¢metro action=ranking)
    const WEBAPP_URL ='https://script.google.com/macros/s/AKfycbzcXQGnggMk5Jp2bUuPTSdn3nFOVwQHS8_cI16Tv6UAibjJSDm2qIulAvbb2OTI6pY/exec?action=ranking';

    // Callback JSONP chamado pelo Web App com o array de ranking
    function showRanking(data){
      const tbody = document.querySelector('#rankingTable tbody');
      tbody.innerHTML = '';
      if (!data || !data.length) {
        tbody.innerHTML = '<tr><td colspan="3" style="padding:18px; text-align:center; color:#ccc;">Nenhum registro</td></tr>';
        return;
      }

      data.forEach((item, idx) => {
        const tr = document.createElement('tr');
        if (idx === 0) tr.classList.add('rank-1');
        if (idx === 1) tr.classList.add('rank-2');
        if (idx === 2) tr.classList.add('rank-3');

        // Adiciona medalhas nas primeiras posi√ß√µes
        const medalha = idx === 0 ? 'ü•á ' : idx === 1 ? 'ü•à ' : idx === 2 ? 'ü•â ' : '';
        const tdNome = document.createElement('td'); 
        tdNome.textContent = medalha + item.nome;

        const tdEscola = document.createElement('td'); 
        tdEscola.textContent = item.escola;

        const tdPontos = document.createElement('td'); 
        tdPontos.textContent = item.pontos;

        tr.appendChild(tdNome);
        tr.appendChild(tdEscola);
        tr.appendChild(tdPontos);
        tbody.appendChild(tr);
      });
    }

    // Carrega dados via JSONP
    function loadDataJSONP(){
      const old = document.getElementById('jsonpScript');
      if(old) old.remove();

      const s = document.createElement('script');
      s.id = 'jsonpScript';
      s.src = WEBAPP_URL + '&callback=showRanking&ts=' + Date.now();
      s.async = true;
      document.body.appendChild(s);
    }

    // Inicializa a chamada e atualiza a cada 30 segundos
    (function init(){
      if (!WEBAPP_URL || WEBAPP_URL.indexOf('https://') !== 0) {
        const tbody = document.querySelector('#rankingTable tbody');
        tbody.innerHTML = '<tr><td colspan="3" style="padding:18px; text-align:center; color:orange;">ERRO: cole a URL do Web App corretamente em WEBAPP_URL</td></tr>';
        return;
      }
      loadDataJSONP();
      setInterval(loadDataJSONP, 30000);
    })();
  </script>
</body>
</html>

